<!DOCTYPE html>
<html>

<head>
    <!-- Include jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Add Socket.IO JavaScript client -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.js"></script>

    <style>
        .hidden { display: none; }
        #cmdGuideTable, #cmdGuideTable th, #cmdGuideTable td {
            border: 1px solid black;
            border-collapse: collapse;
        }
        #cmdGuideTable {
            width: 100%;
            margin-bottom: 20px; /* Adjust space between table and form */
        }
        #cmdGuideTable th, #cmdGuideTable td {
            padding: 5px;
            text-align: left;
        }
    </style>
</head>

<body>
    <!-- CMD Guide Table -->
    <table id="cmdGuideTable">
        <thead>
            <tr>
                <th>CMD</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Word of The Day in Japanese</td>
                <td>Give 5 words in Japanese based on the tag given, Make sure you tabulate them as Japanese word, Furigana, English word, and example sentence in respective columns</td>
            </tr>
            <tr>
                <td>A Story</td>
                <td>I Will Write a Japanese story in Japanese, followed with a summary in English and in the end under the header difficult words separately list difficult Japanese words and their English translations. Japanese Story has heading as title, the English summary which follows the Japanese story has title English Summary, and the difficult words are under the header difficult words as (日本語・English Pronunciation) deviation from the format would be harmful</td>
            </tr>
            <!-- Add more rows for additional CMDs -->
        </tbody>
    </table>

    <form id="promptForm">
        <label for="CMD">CMD:</label>
        <input type="text" id="CMD" name="CMD">
        
        <label for="tag">Tag:</label>
        <input type="text" id="tag" name="tag">
        
        <label for="SPINS">SPINS:</label>
        <input type="text" id="SPINS" name="SPINS">
        
        <input type="button" value="Submit" onclick="sendPromptData()">
    </form>

    <div id="loadingIndicator" style="display: none;">Loading...</div>
    <div id="japaneseStory"></div>
    <div id="englishSummary"></div>
    <div id="imageContainer"></div>
    <ul id="difficultWords"></ul>

    <script>
        var socket = io();
    
        function sendPromptData() {
            var CMD = $("#CMD").val();
            var tag = $("#tag").val();
            var SPINS = $("#SPINS").val();
            console.log("Sending CMD:", CMD); // Log the command being sent
            $("#loadingIndicator").show();
            $("#japaneseStory").html("");
            $("#englishSummary").html("");
            $("#difficultWords").empty();
            $("#imageContainer").empty();
            $("#cmdGuideTable").addClass('hidden');
            socket.emit('send_prompt', {CMD: CMD, tag: tag, SPINS: SPINS});
        }
    
        socket.on('prompt_response', function(data) {
            console.log("Received Data:", data); // Log the received data
            var CMD = $("#CMD").val(); // Ensure CMD is correctly captured here
            console.log("Processing CMD:", CMD); // Log the CMD being processed
            $("#loadingIndicator").hide();
            
            if(data.error) {
                alert(data.error);
                return;
            }
    
            if (CMD === "A Story") {
                // Existing code for processing 'A Story' command
            } else if (CMD === "Word of The Day in Japanese") {
                // Processing for 'Word of The Day in Japanese' command
            } else {
                $("#japaneseStory").html("<p>No data received or unrecognized command.</p>");
            }
        });
    </script>
    

    
</body>

</html>
